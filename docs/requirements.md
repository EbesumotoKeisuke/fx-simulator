# 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
FX Trade Simulator（FXトレードシミュレーター）

### 1.2 概要説明
実際のFX市場に近い環境でトレードの練習ができるシミュレーションツール。過去の為替データを使用してリアルな相場環境を再現し、仮想資金でトレードを行うことで、リスクなくトレードスキルを磨くことができる。

### 1.3 目的・背景
- **目的**: ユーザーのFXトレードスキル向上を支援する
- **背景**: 実際の資金を使わずにトレード経験を積むことで、リスク管理や相場分析のスキルを安全に習得したい

## 2. ユーザー定義

### 2.1 想定ユーザー
- 個人利用（開発者本人のみ）
- FXトレードの練習・スキル向上を目指す個人トレーダー

### 2.2 ユーザーの課題・ニーズ
| 課題 | ニーズ |
|------|--------|
| 実資金でのトレードはリスクが高い | リスクなしで練習したい |
| 過去の相場で自分の判断を検証したい | 過去データでのバックテスト機能 |
| トレードの記録・分析が手間 | 自動で履歴を記録し分析したい |
| 感情的なトレードを減らしたい | 客観的なパフォーマンス指標の確認 |

## 3. 機能要件

### 3.1 必須機能（MVP）
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-001 | マルチタイムフレームチャート表示 | 日足・1時間足・10分足のローソク足チャートを同時表示。各時間足の最新時刻は同期して一致すること | 高 |
| F-002 | 過去データ再生 | 過去の為替データを時系列で再生（早送り・一時停止可能） | 高 |
| F-003 | 注文機能 | 成行注文（買い/売り）の発注 | 高 |
| F-004 | ポジション管理 | 保有中のポジション一覧表示・決済。ロットサイズ、購入価格（エントリー価格）を表示 | 高 |
| F-005 | 損益計算 | リアルタイムの含み損益・確定損益の計算・表示 | 高 |
| F-006 | 仮想資金管理 | 初期資金の設定、残高管理 | 高 |
| F-007 | トレード履歴 | 過去のトレード履歴の記録・一覧表示 | 高 |
| F-008 | 為替データ読込 | ローカルフォルダに格納されたCSVファイル（日足・1時間足・10分足）から為替データを読み込む | 高 |

### 3.2 追加機能（あれば嬉しい）
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-101 | 指値・逆指値注文 | 価格指定での予約注文 | 中 |
| F-102 | 損切り・利確設定 | ポジションごとのSL/TP設定 | 中 |
| F-103 | 複数通貨ペア対応 | USD/JPY以外の通貨ペアにも対応 | 中 |
| F-104 | テクニカル指標 | 移動平均線、RSI、MACD等の表示 | 中 |
| F-105 | パフォーマンス分析 | 勝率、プロフィットファクター、最大ドローダウン等の統計 | 中 |
| F-106 | トレードメモ | 各トレードにメモ・振り返りを記録 | 低 |
| F-107 | 再生速度調整 | チャート再生速度の細かい調整（0.5x〜10x） | 低 |
| F-108 | シミュレーション開始日時指定 | 任意の日時からシミュレーションを開始できる | 中 |
| F-109 | シミュレーション終了・CSV出力 | 終了ボタンでシミュレーションを終了し、トレード履歴をCSVファイルとして出力 | 中 |
| F-110 | 統合画面レイアウト | 日足・1時間足・10分足チャートとトレード操作パネル（注文・ポジション管理）を1画面に同時表示 | 高 |
| F-111 | 外部データソース取込 | 外部の無料データソースから過去の為替データを取得し、ローカルCSVファイルに追記・更新する | 中 |

## 4. 非機能要件

### 4.1 性能要件
- チャートの描画はスムーズに動作すること（60fps目標）
- 過去データの読み込みは5秒以内
- 注文処理は即座に反映されること

### 4.2 セキュリティ要件
- 個人利用のため、認証機能は不要
- ローカル環境での動作を前提

### 4.3 可用性要件
- ローカル環境で安定して動作すること
- データの永続化（ブラウザを閉じてもトレード履歴が保持される）

### 4.4 保守性要件
- コードは可読性を重視
- 機能追加が容易な設計

## 5. 制約条件

### 5.1 技術的制約
- バックエンド: Python（FastAPI）
- フロントエンド: React（TypeScript）
- データベース: PostgreSQL
- 開発環境: Docker
- 為替データ:
  - ユーザーが用意したCSVファイル（日足・1時間足・10分足）をローカルフォルダに格納
  - 不足データは外部の無料データソース（例: Yahoo Finance API等）から取得可能

### 5.2 スケジュール制約
- 特になし（個人プロジェクト）

### 5.3 その他制約
- 実際の取引所との接続は行わない（シミュレーションのみ）
- リアルタイムデータ配信は行わない（過去データの再生のみ）

## 6. 用語定義
| 用語 | 説明 |
|------|------|
| ポジション | 保有中の通貨の持ち高（買いまたは売りの状態） |
| 成行注文 | 現在の市場価格で即座に約定する注文 |
| 指値注文 | 指定した価格に達したら約定する予約注文 |
| 逆指値注文 | 指定した価格に達したら成行で約定する予約注文 |
| SL（ストップロス） | 損切りライン。損失を限定するための決済価格 |
| TP（テイクプロフィット） | 利確ライン。利益を確定するための決済価格 |
| pips | 為替レートの最小変動単位（USD/JPYの場合0.01円） |
| ロット | 取引数量の単位（1ロット = 10万通貨が一般的） |
| スプレッド | 買値と売値の差額 |
| ドローダウン | 資産のピークからの下落幅 |
| プロフィットファクター | 総利益 ÷ 総損失 |

## 7. 前提条件・依存関係
- ユーザーが為替データCSVファイル（日足・1時間足・10分足）を用意し、所定のフォルダに格納すること
- CSVファイルのフォーマット: 日時, 始値, 高値, 安値, 終値, 出来高（OHLCV形式）
- Docker環境が利用可能であること
- モダンブラウザ（Chrome, Firefox, Edge等）で動作
- 外部データソース利用時はインターネット接続が必要

## 8. 将来の拡張性
- リアルタイムデータとの連携（将来的に）
- 自動売買ロジックのバックテスト機能
- 複数の取引戦略のパフォーマンス比較
- モバイル対応
